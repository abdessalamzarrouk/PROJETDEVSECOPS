<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:fragment="common_head(pageTitle)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}"></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script> <!-- Alpine.js included here -->
    <style>
        /* Essentiel pour que min-h-screen fonctionne correctement sur le corps */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        .card {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Custom styles for status badges - Common for multiple pages */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }
        .status-VALIDE {
            background-color: #d1fae5;
            color: #065f46;
        }
        .status-EN_ATTENTE {
            background-color: #fef3c7;
            color: #92400e;
        }
        .status-REJETE {
            background-color: #fee2e2;
            color: #991b1b;
        }

        /* Article Recette Status Badges - Might be used elsewhere */
        .article-status-badge {
            padding: 0.15rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }
        .article-status-VALIDE {
            background-color: #dcfce7;
            color: #166534;
        }
        .article-status-EN_ATTENTE {
            background-color: #e0f2fe;
            color: #1d4ed8;
        }
        .article-status-REJETE {
            background-color: #ffe4e6;
            color: #be123c;
        }

        /* Alpine.js modal classes - Added common modal styles */
        .modal {
            transition: opacity 0.2s ease-in-out;
        }
    </style>
</head>
<body>

<!-- Sidebar Fragment -->
<aside th:fragment="sidebar(activeMenu, connectedUserFullName)"
       class="w-64 bg-gray-900 text-gray-200 flex-shrink-0 h-full sticky top-0 overflow-y-auto">

    <div class="w-full h-25 overflow-hidden flex items-center justify-center">
        <img th:src="@{/images/TGR-LOGO2.svg}" alt="Your Logo" class="w-full h-full object-cover">
    </div>

    <div class="p-6">
        <nav>
            <ul>
                <li class="mb-2">
                    <a th:href="@{/comptable/dashboard}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'dashboard' ? 'bg-gray-700 text-white' : ''}">Tableau de bord</a>
                </li>
                <li class="mb-2">
                    <a th:href="@{/bordereaux}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'bordereaux' ? 'bg-gray-700 text-white' : ''}">Bordereaux</a>
                </li>
                <li class="mb-2">
                    <a th:href="@{/articles-recette}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'articles-recette' ? 'bg-gray-700 text-white' : ''}">Articles de Recette</a>
                </li>
                <li class="mb-2">
                    <a th:href="@{/operations-recette}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'operations-recette' ? 'bg-gray-700 text-white' : ''}">Opérations de Recette</a>
                </li>
                <li class="mb-2">
                    <a th:href="@{/rubriques-budgetaires}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'rubriques-budgetaires' ? 'bg-gray-700 text-white' : ''}">Rubriques Budgétaires</a>
                </li>
                <li class="mb-2">
                    <a th:href="@{/reports}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'reports' ? 'bg-gray-700 text-white' : ''}">Rapports</a>
                </li>
                <li class="my-4 border-t border-gray-700"></li>
                <li class="mb-2">
                    <a th:href="@{/profile}" class="block py-2 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white"
                       th:classappend="${activeMenu == 'profile' ? 'bg-gray-700 text-white' : ''}">Profil</a>
                </li>
                <!-- Removed settings link as per previous request -->
                <li>
                    <form th:action="@{/logout}" method="post" class="w-full">
                        <button type="submit" class="block w-full text-left py-2 px-4 rounded transition duration-200 hover:bg-red-700 hover:text-white text-red-300">
                            Déconnexion
                        </button>
                    </form>
                </li>
            </ul>
        </nav>
    </div>
    <div class="p-6 text-center text-sm text-gray-400 border-t border-gray-700 mt-4">
        Connecté en tant que: <br>
        <strong th:text="${connectedUserFullName ?: 'Invité'}" class="text-white"></strong>
    </div>
</aside>

<!-- Main Content Header Fragment -->
<div th:fragment="main_content_header(headerTitle, connectedUserFullName)"
     class="flex justify-between items-center mb-6 border-b pb-4">
    <h1 class="text-3xl font-bold text-gray-800" th:text="${headerTitle}"></h1>
    <div class="flex items-center space-x-4">
        <span class="text-gray-600">Connecté en tant que : <strong th:text="${connectedUserFullName ?: 'Chargement...'}" class="text-indigo-600"></strong></span>
    </div>
</div>

<!-- Alert Messages Fragment -->
<div th:fragment="alert_messages(success, error)">
    <div th:if="${success}" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
        <strong class="font-bold">Succès!</strong>
        <span class="block sm:inline" th:text="${success}"></span>
    </div>
    <div th:if="${error}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <strong class="font-bold">Erreur!</strong>
        <span class="block sm:inline" th:text="${error}"></span>
    </div>
</div>

</body>
</html>